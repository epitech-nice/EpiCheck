apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
    - namespace.yaml
    - configmap.yaml
    - secrets.yaml
    - deployment.yaml
    - service.yaml
    - ingress.yaml
    - hpa.yaml
    - pvc.yaml
    - network-policy.yaml

commonLabels:
    app: epicheck
    managed-by: kustomize

images:
    - name: epicheck
      newName: your-registry/epicheck
      newTag: latest
    - name: epicheck-proxy
      newName: your-registry/epicheck-proxy
      newTag: latest

# Configuration transformers
configMapGenerator:
    - name: epicheck-config
      behavior: merge
      literals:
          - DEPLOYMENT_DATE=$(date +%Y-%m-%d)

# Replicas overlay
replicas:
    - name: epicheck-app
      count: 1
    - name: epicheck-proxy
      count: 1
